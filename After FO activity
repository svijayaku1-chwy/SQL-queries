After FO activity
WITH FIRST_WEB_VISIT_AFTER_FO AS (
  SELECT
  CUSTOMER_ID,
  COUNT(DISTINCT UNIQUE_VISIT_ID) AS FIRST_VISIT_SESSIONS_AFTER_FO,
  COUNT(CASE WHEN EVENT_ACTION = 'impression' THEN UNIQUE_VISIT_ID ELSE NULL END) AS FIRST_VISIT_IMPRESSION_AFTER_FO,
  COUNT(CASE WHEN EVENT_ACTION like '%click%' THEN UNIQUE_VISIT_ID ELSE NULL END) AS FIRST_VISIT_CLICK_AFTER_FO,
  MIN(DAYS_SINCE_FIRST_ORDER) AS DAYS_TO_FIRST_SESSION_AFTER_FO,
  COUNT(CASE WHEN lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN UNIQUE_VISIT_ID ELSE NULL END) AS FIRST_VISIT_PDP,
  COUNT(CASE WHEN EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN UNIQUE_VISIT_ID ELSE NULL END) AS FIRST_VISIT_PLP,
  COUNT(CASE WHEN PAGE_PATH = '/' THEN UNIQUE_VISIT_ID ELSE NULL END) AS FIRST_VISIT_HP,
  MIN(CASE WHEN lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN HIT_NUMBER ELSE NULL END) AS MIN_PDP_HIT_NUMBER,
  MIN(CASE WHEN EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN HIT_NUMBER ELSE NULL END) AS MIN_PLP_HIT_NUMBER,
  MIN(CASE WHEN PAGE_PATH = '/' THEN HIT_NUMBER ELSE NULL END) AS MIN_HP_HIT_NUMBER,
  MAX(CASE WHEN TOTALS:transactionRevenue > 0 THEN 1 ELSE 0 END) AS FIRST_VISIT_PURCHASED,
  MAX(CASE WHEN CHANNEL_GROUPING = 'Email' THEN 1 ELSE 0 END) AS FIRST_EMAIL,
  MAX(CASE WHEN CHANNEL_GROUPING = 'Direct' THEN 1 ELSE 0 END) AS FIRST_DIRECT,
  MAX(CASE WHEN CHANNEL_GROUPING = 'PLA' THEN 1 ELSE 0 END) AS FIRST_PLA,
  MAX(CASE WHEN CHANNEL_GROUPING = 'Organic Search' THEN 1 ELSE 0 END) AS FIRST_OS,
  MAX(CASE WHEN CHANNEL_GROUPING = 'Affiliates' THEN 1 ELSE 0 END) AS FIRST_AFF,
  MAX(CASE WHEN CHANNEL_GROUPING = 'Chewy Paid Search' THEN 1 ELSE 0 END) AS FIRST_CPS
 
  FROM (
    SELECT
    *,
    DENSE_RANK() OVER (PARTITION BY CUSTOMER_ID ORDER BY GA_SESSIONS_DATE ASC) AS RANK,
    DATEDIFF('day',FIRST_ORDER_DATE, GA_SESSIONS_DATE) AS DAYS_SINCE_FIRST_ORDER
 
    FROM ECOM_SANDBOX.MC1_SESSIONS_KJ
    WHERE GA_SESSIONS_DATE > FIRST_ORDER_DATE
    )
  WHERE RANK = 1
  GROUP BY 1
),
 
SESSIONS AS (
  SELECT
  CUSTOMER_ID,
  COUNT(DISTINCT CASE WHEN GA_SESSIONS_DATE <= FIRST_ORDER_DATE THEN UNIQUE_VISIT_ID ELSE NULL END ) AS SESSION_BEFORE_FO,
  COUNT(DISTINCT CASE WHEN GA_SESSIONS_DATE BETWEEN FIRST_ORDER_DATE AND DATEADD('day',30,FIRST_ORDER_DATE) THEN UNIQUE_VISIT_ID ELSE NULL END ) AS SESSION_AFTER_FO_30D,
  COUNT(DISTINCT CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',30,FIRST_ORDER_DATE) AND DATEADD('day',60,FIRST_ORDER_DATE) THEN UNIQUE_VISIT_ID ELSE NULL END ) AS SESSION_AFTER_FO_60D,
  COUNT(DISTINCT CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',60,FIRST_ORDER_DATE) AND DATEADD('day',90,FIRST_ORDER_DATE) THEN UNIQUE_VISIT_ID ELSE NULL END ) AS SESSION_AFTER_FO_90D,
  COUNT(DISTINCT CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',90,FIRST_ORDER_DATE) AND DATEADD('day',120,FIRST_ORDER_DATE) THEN UNIQUE_VISIT_ID ELSE NULL END ) AS SESSION_AFTER_FO_120D,
  COUNT(DISTINCT CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',120,FIRST_ORDER_DATE) AND DATEADD('day',150,FIRST_ORDER_DATE) THEN UNIQUE_VISIT_ID ELSE NULL END ) AS SESSION_AFTER_FO_150D,
  COUNT(DISTINCT CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',150,FIRST_ORDER_DATE) AND DATEADD('day',180,FIRST_ORDER_DATE) THEN UNIQUE_VISIT_ID ELSE NULL END ) AS SESSION_AFTER_FO_180D,
 
  COUNT(CASE WHEN GA_SESSIONS_DATE <= FIRST_ORDER_DATE AND EVENT_ACTION = 'impression' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS IMPRESSION_BEFORE_FO,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN FIRST_ORDER_DATE AND DATEADD('day',30,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS IMPRESSION_AFTER_FO_30D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',30,FIRST_ORDER_DATE) AND DATEADD('day',60,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS IMPRESSION_AFTER_FO_60D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',60,FIRST_ORDER_DATE) AND DATEADD('day',90,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS IMPRESSION_AFTER_FO_90D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',90,FIRST_ORDER_DATE) AND DATEADD('day',120,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS IMPRESSION_AFTER_FO_120D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',120,FIRST_ORDER_DATE) AND DATEADD('day',150,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS IMPRESSION_AFTER_FO_150D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',150,FIRST_ORDER_DATE) AND DATEADD('day',180,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS IMPRESSION_AFTER_FO_180D,
 
  COUNT(CASE WHEN GA_SESSIONS_DATE <= FIRST_ORDER_DATE AND EVENT_ACTION like '%click%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS CLICK_BEFORE_FO,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN FIRST_ORDER_DATE AND DATEADD('day',30,FIRST_ORDER_DATE) AND EVENT_ACTION like '%click%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS CLICK_AFTER_FO_30D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',30,FIRST_ORDER_DATE) AND DATEADD('day',60,FIRST_ORDER_DATE) AND EVENT_ACTION like '%click%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS CLICK_AFTER_FO_60D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',60,FIRST_ORDER_DATE) AND DATEADD('day',90,FIRST_ORDER_DATE) AND EVENT_ACTION like '%click%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS CLICK_AFTER_FO_90D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',90,FIRST_ORDER_DATE) AND DATEADD('day',120,FIRST_ORDER_DATE) AND EVENT_ACTION like '%click%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS CLICK_AFTER_FO_120D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',120,FIRST_ORDER_DATE) AND DATEADD('day',150,FIRST_ORDER_DATE) AND EVENT_ACTION like '%click%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS CLICK_AFTER_FO_150D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',150,FIRST_ORDER_DATE) AND DATEADD('day',180,FIRST_ORDER_DATE) AND EVENT_ACTION like '%click%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS CLICK_AFTER_FO_180D,
 
  COUNT(CASE WHEN GA_SESSIONS_DATE <= FIRST_ORDER_DATE AND lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PDP_BEFORE_FO,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN FIRST_ORDER_DATE AND DATEADD('day',30,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PDP_AFTER_FO_30D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',30,FIRST_ORDER_DATE) AND DATEADD('day',60,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PDP_AFTER_FO_60D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',60,FIRST_ORDER_DATE) AND DATEADD('day',90,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PDP_AFTER_FO_90D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',90,FIRST_ORDER_DATE) AND DATEADD('day',120,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PDP_AFTER_FO_120D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',120,FIRST_ORDER_DATE) AND DATEADD('day',150,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PDP_AFTER_FO_150D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',150,FIRST_ORDER_DATE) AND DATEADD('day',180,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) = 'detail' AND lower(EVENT_CATEGORY) = 'eec' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PDP_AFTER_FO_180D,
 
  COUNT(CASE WHEN GA_SESSIONS_DATE <= FIRST_ORDER_DATE AND EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PLP_BEFORE_FO,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN FIRST_ORDER_DATE AND DATEADD('day',30,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PLP_AFTER_FO_30D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',30,FIRST_ORDER_DATE) AND DATEADD('day',60,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PLP_AFTER_FO_60D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',60,FIRST_ORDER_DATE) AND DATEADD('day',90,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PLP_AFTER_FO_90D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',90,FIRST_ORDER_DATE) AND DATEADD('day',120,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PLP_AFTER_FO_120D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',120,FIRST_ORDER_DATE) AND DATEADD('day',150,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PLP_AFTER_FO_150D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',150,FIRST_ORDER_DATE) AND DATEADD('day',180,FIRST_ORDER_DATE) AND EVENT_ACTION = 'impression' AND lower(EVENT_LABEL) in ('search-results','browse','brand-page','deals') THEN UNIQUE_VISIT_ID ELSE NULL END ) AS PLP_AFTER_FO_180D,
 
  COUNT(CASE WHEN GA_SESSIONS_DATE <= FIRST_ORDER_DATE AND lower(EVENT_ACTION) like '%add%to%cart%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS ATC_BEFORE_FO,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN FIRST_ORDER_DATE AND DATEADD('day',30,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) like '%add%to%cart%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS ATC_AFTER_FO_30D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',30,FIRST_ORDER_DATE) AND DATEADD('day',60,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) like '%add%to%cart%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS ATC_AFTER_FO_60D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',60,FIRST_ORDER_DATE) AND DATEADD('day',90,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) like '%add%to%cart%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS ATC_AFTER_FO_90D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',90,FIRST_ORDER_DATE) AND DATEADD('day',120,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) like '%add%to%cart%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS ATC_AFTER_FO_120D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',120,FIRST_ORDER_DATE) AND DATEADD('day',150,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) like '%add%to%cart%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS ATC_AFTER_FO_150D,
  COUNT(CASE WHEN GA_SESSIONS_DATE BETWEEN DATEADD('day',150,FIRST_ORDER_DATE) AND DATEADD('day',180,FIRST_ORDER_DATE) AND lower(EVENT_ACTION) like '%add%to%cart%' THEN UNIQUE_VISIT_ID ELSE NULL END ) AS ATC_AFTER_FO_180D
 
  FROM ECOM_SANDBOX.MC1_SESSIONS_KJ
  GROUP BY 1
)
 
SELECT
A.CUSTOMER_ID,
A.ACTIVE_3M,
A.FIRST_ORDER_MC2,
CURRENT_NUMBER_OF_MC1,
FIRST_ORDER_APPAREL,
FIRST_ORDER_LEASH,
FIRST_ORDER_TREAT,
FIRST_ORDER_TOY,
FIRST_ORDER_BED,
FIRST_ORDER_LITTER,
FIRST_ORDER_FOOD,
FIRST_ORDER_BEAUTY,
FIRST_ORDER_CONTAINMENT,
FIRST_ORDER_PREMIUM,
FIRST_ORDER_BOWL,
FIRST_ORDER_PERSONALIZED,
FIRST_ORDER_WASTE,
FIRST_ORDER_PERISHABLE,
FIRST_VISIT_SESSIONS_AFTER_FO,
FIRST_VISIT_IMPRESSION_AFTER_FO,
FIRST_VISIT_CLICK_AFTER_FO,
DAYS_TO_FIRST_SESSION_AFTER_FO,
FIRST_VISIT_PDP,
FIRST_VISIT_PLP,
FIRST_VISIT_HP,
MIN_PDP_HIT_NUMBER,
MIN_PLP_HIT_NUMBER,
MIN_HP_HIT_NUMBER,
FIRST_VISIT_PURCHASED,
FIRST_EMAIL,
FIRST_DIRECT,
FIRST_PLA,
FIRST_OS,
FIRST_AFF,
FIRST_CPS,
COALESCE(SESSION_BEFORE_FO,0) AS SESSION_BEFORE_FO,
COALESCE(SESSION_AFTER_FO_30D,0) AS SESSION_AFTER_FO_30D,
COALESCE(SESSION_AFTER_FO_60D,0) AS SESSION_AFTER_FO_60D,
COALESCE(SESSION_AFTER_FO_90D,0) AS SESSION_AFTER_FO_90D,
COALESCE(SESSION_AFTER_FO_120D,0) AS SESSION_AFTER_FO_120D,
COALESCE(SESSION_AFTER_FO_150D,0) AS SESSION_AFTER_FO_150D,
COALESCE(SESSION_AFTER_FO_180D,0) AS SESSION_AFTER_FO_180D,
COALESCE(IMPRESSION_BEFORE_FO,0) AS IMPRESSION_BEFORE_FO,
COALESCE(IMPRESSION_AFTER_FO_30D,0) AS IMPRESSION_AFTER_FO_30D,
COALESCE(IMPRESSION_AFTER_FO_60D,0) AS IMPRESSION_AFTER_FO_60D,
COALESCE(IMPRESSION_AFTER_FO_90D,0) AS IMPRESSION_AFTER_FO_90D,
COALESCE(IMPRESSION_AFTER_FO_120D,0) AS IMPRESSION_AFTER_FO_120D,
COALESCE(IMPRESSION_AFTER_FO_150D,0) AS IMPRESSION_AFTER_FO_150D,
COALESCE(IMPRESSION_AFTER_FO_180D,0) AS IMPRESSION_AFTER_FO_180D,
COALESCE(CLICK_BEFORE_FO,0) AS CLICK_BEFORE_FO,
COALESCE(CLICK_AFTER_FO_30D,0) AS CLICK_AFTER_FO_30D,
COALESCE(CLICK_AFTER_FO_60D,0) AS CLICK_AFTER_FO_60D,
COALESCE(CLICK_AFTER_FO_90D,0) AS CLICK_AFTER_FO_90D,
COALESCE(CLICK_AFTER_FO_120D,0) AS CLICK_AFTER_FO_120D,
COALESCE(CLICK_AFTER_FO_150D,0) AS CLICK_AFTER_FO_150D,
COALESCE(CLICK_AFTER_FO_180D,0) AS CLICK_AFTER_FO_180D,
COALESCE(PDP_BEFORE_FO,0) AS PDP_BEFORE_FO,
COALESCE(PDP_AFTER_FO_30D,0) AS PDP_AFTER_FO_30D,
COALESCE(PDP_AFTER_FO_60D,0) AS PDP_AFTER_FO_60D,
COALESCE(PDP_AFTER_FO_90D,0) AS PDP_AFTER_FO_90D,
COALESCE(PDP_AFTER_FO_120D,0) AS PDP_AFTER_FO_120D,
COALESCE(PDP_AFTER_FO_150D,0) AS PDP_AFTER_FO_150D,
COALESCE(PDP_AFTER_FO_180D,0) AS PDP_AFTER_FO_180D,
COALESCE(PLP_BEFORE_FO,0) AS PLP_BEFORE_FO,
COALESCE(PLP_AFTER_FO_30D,0) AS PLP_AFTER_FO_30D,
COALESCE(PLP_AFTER_FO_60D,0) AS PLP_AFTER_FO_60D,
COALESCE(PLP_AFTER_FO_90D,0) AS PLP_AFTER_FO_90D,
COALESCE(PLP_AFTER_FO_120D,0) AS PLP_AFTER_FO_120D,
COALESCE(PLP_AFTER_FO_150D,0) AS PLP_AFTER_FO_150D,
COALESCE(PLP_AFTER_FO_180D,0) AS PLP_AFTER_FO_180D,
COALESCE(ATC_BEFORE_FO,0) AS ATC_BEFORE_FO,
COALESCE(ATC_AFTER_FO_30D,0) AS ATC_AFTER_FO_30D,
COALESCE(ATC_AFTER_FO_60D,0) AS ATC_AFTER_FO_60D,
COALESCE(ATC_AFTER_FO_90D,0) AS ATC_AFTER_FO_90D,
COALESCE(ATC_AFTER_FO_120D,0) AS ATC_AFTER_FO_120D,
COALESCE(ATC_AFTER_FO_150D,0) AS ATC_AFTER_FO_150D,
COALESCE(ATC_AFTER_FO_180D,0) AS ATC_AFTER_FO_180D
 
FROM ECOM_SANDBOX.MC1_ANALYSIS_KJ A
LEFT JOIN FIRST_WEB_VISIT_AFTER_FO B
ON A.CUSTOMER_ID = B.CUSTOMER_ID
 
LEFT JOIN SESSIONS C
ON A.CUSTOMER_ID = C.CUSTOMER_ID